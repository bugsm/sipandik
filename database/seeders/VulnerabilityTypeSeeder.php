<?php

namespace Database\Seeders;

use App\Models\VulnerabilityType;
use Illuminate\Database\Seeder;

class VulnerabilityTypeSeeder extends Seeder
{
    /**
     * Run the database seeds.
     * Jenis-jenis kerentanan berdasarkan OWASP dan standar keamanan lainnya
     */
    public function run(): void
    {
        $vulnerabilityTypes = [
            // Critical
            [
                'kode' => 'SQL-INJ',
                'nama' => 'SQL Injection',
                'deskripsi' => 'Kerentanan yang memungkinkan penyerang menyisipkan perintah SQL melalui input aplikasi untuk mengakses atau memanipulasi database.',
                'severity' => 'critical',
                'urutan' => 1,
                'is_active' => true,
            ],
            [
                'kode' => 'RCE',
                'nama' => 'Remote Code Execution',
                'deskripsi' => 'Kerentanan yang memungkinkan penyerang menjalankan kode berbahaya pada server secara remote.',
                'severity' => 'critical',
                'urutan' => 2,
                'is_active' => true,
            ],
            [
                'kode' => 'AUTH-BYPASS',
                'nama' => 'Authentication Bypass',
                'deskripsi' => 'Kerentanan yang memungkinkan penyerang melewati mekanisme autentikasi dan mengakses sistem tanpa kredensial yang valid.',
                'severity' => 'critical',
                'urutan' => 3,
                'is_active' => true,
            ],

            // High
            [
                'kode' => 'XSS',
                'nama' => 'Cross-Site Scripting (XSS)',
                'deskripsi' => 'Kerentanan yang memungkinkan penyerang menyisipkan skrip berbahaya ke dalam halaman web yang dilihat pengguna lain.',
                'severity' => 'high',
                'urutan' => 4,
                'is_active' => true,
            ],
            [
                'kode' => 'CSRF',
                'nama' => 'Cross-Site Request Forgery (CSRF)',
                'deskripsi' => 'Kerentanan yang memaksa pengguna yang sudah terautentikasi untuk menjalankan aksi yang tidak diinginkan.',
                'severity' => 'high',
                'urutan' => 5,
                'is_active' => true,
            ],
            [
                'kode' => 'FILE-UPLOAD',
                'nama' => 'Unrestricted File Upload',
                'deskripsi' => 'Kerentanan yang memungkinkan upload file berbahaya ke server karena validasi yang tidak memadai.',
                'severity' => 'high',
                'urutan' => 6,
                'is_active' => true,
            ],
            [
                'kode' => 'IDOR',
                'nama' => 'Insecure Direct Object Reference (IDOR)',
                'deskripsi' => 'Kerentanan yang memungkinkan akses ke objek atau data milik pengguna lain dengan memanipulasi parameter.',
                'severity' => 'high',
                'urutan' => 7,
                'is_active' => true,
            ],
            [
                'kode' => 'PATH-TRAV',
                'nama' => 'Path Traversal',
                'deskripsi' => 'Kerentanan yang memungkinkan akses ke file dan direktori di luar web root directory.',
                'severity' => 'high',
                'urutan' => 8,
                'is_active' => true,
            ],

            // Medium
            [
                'kode' => 'SSRF',
                'nama' => 'Server-Side Request Forgery (SSRF)',
                'deskripsi' => 'Kerentanan yang memungkinkan penyerang membuat request dari server ke resource internal.',
                'severity' => 'medium',
                'urutan' => 9,
                'is_active' => true,
            ],
            [
                'kode' => 'BROKEN-AUTH',
                'nama' => 'Broken Authentication',
                'deskripsi' => 'Kelemahan dalam implementasi autentikasi yang dapat dieksploitasi untuk mencuri identitas pengguna.',
                'severity' => 'medium',
                'urutan' => 10,
                'is_active' => true,
            ],
            [
                'kode' => 'SESSION',
                'nama' => 'Session Management Issues',
                'deskripsi' => 'Kelemahan dalam pengelolaan session seperti session fixation atau session hijacking.',
                'severity' => 'medium',
                'urutan' => 11,
                'is_active' => true,
            ],
            [
                'kode' => 'INFO-DISC',
                'nama' => 'Information Disclosure',
                'deskripsi' => 'Kebocoran informasi sensitif seperti error message, source code, atau data konfigurasi.',
                'severity' => 'medium',
                'urutan' => 12,
                'is_active' => true,
            ],
            [
                'kode' => 'MISCONFIG',
                'nama' => 'Security Misconfiguration',
                'deskripsi' => 'Kesalahan konfigurasi keamanan pada server, framework, atau aplikasi.',
                'severity' => 'medium',
                'urutan' => 13,
                'is_active' => true,
            ],

            // Low
            [
                'kode' => 'CLICKJACK',
                'nama' => 'Clickjacking',
                'deskripsi' => 'Teknik untuk mengelabui pengguna agar mengklik sesuatu yang berbeda dari yang mereka lihat.',
                'severity' => 'low',
                'urutan' => 14,
                'is_active' => true,
            ],
            [
                'kode' => 'OPEN-REDIRECT',
                'nama' => 'Open Redirect',
                'deskripsi' => 'Kerentanan yang memungkinkan pengalihan pengguna ke URL berbahaya melalui parameter.',
                'severity' => 'low',
                'urutan' => 15,
                'is_active' => true,
            ],
            [
                'kode' => 'WEAK-CRYPTO',
                'nama' => 'Weak Cryptography',
                'deskripsi' => 'Penggunaan algoritma kriptografi yang lemah atau tidak aman.',
                'severity' => 'low',
                'urutan' => 16,
                'is_active' => true,
            ],
            [
                'kode' => 'MISSING-HEADERS',
                'nama' => 'Missing Security Headers',
                'deskripsi' => 'Tidak adanya security headers seperti X-Frame-Options, CSP, HSTS, dll.',
                'severity' => 'low',
                'urutan' => 17,
                'is_active' => true,
            ],
            [
                'kode' => 'SSL-ISSUES',
                'nama' => 'SSL/TLS Issues',
                'deskripsi' => 'Masalah pada konfigurasi SSL/TLS seperti cipher suite yang lemah atau sertifikat expired.',
                'severity' => 'low',
                'urutan' => 18,
                'is_active' => true,
            ],
            [
                'kode' => 'OTHER',
                'nama' => 'Lainnya',
                'deskripsi' => 'Jenis kerentanan lainnya yang tidak termasuk dalam kategori di atas.',
                'severity' => 'medium',
                'urutan' => 99,
                'is_active' => true,
            ],
        ];

        foreach ($vulnerabilityTypes as $type) {
            VulnerabilityType::create($type);
        }
    }
}
